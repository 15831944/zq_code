二.VI命令使用
Vi的3种运行模式

普通(normal)模式，又称命令模式
插入(insert)模式
命令行(cmdline)模式
进入Vi后首先进入的是普通模式，Vi等待编辑命令输入，也就是此时输入的字母都将被作为命令来解释。
在普通模式下，输入插入命令i、附加命令a、打开命令o等进入插入模式，在插入模式下用户输入的任何字符都被Vi当作文件内容保存起来，并显示在屏幕。在文本输入过程中，按Esc键返回普通模式。
在普通模式下，执行Ex命令使用:，查找使用?和/，调用Shell命令使用!。末行命令执行完后，Vi自动返回普通模式。

一、普通模式下的操作
进入插入模式

i　　　　光标前插入
I　　　　光标行首插入
a　　　　光标后插入
A　　　　光标行尾插入
o　　　　光标所在行下插入一行，行首插入
O　　　　光标所在行上插入一行，行首插入
光标定位
G　　　　移至最后一行行首
nG　　　　移至第n行行首
n+　　　　下移n行，行首
n-　　　　上移n行，行首
n$　　　　下移n行(1表示本行)，行尾
0　　　　所在行行首
$　　　　所在行行尾
^　　　　所在行首字母
h,j,k,l　　左移，下移，上移，右移
H　　　　当前屏幕首行行首
M　　　　屏幕显示文件的中间行行首
L　　　　当前屏幕最底行行首
替换和删除
rc　　　　用c替换光标所指向的字符
nrc　　　　用c替换光标所指向的前n个字符
x　　　　删除光标处的字符
nx　　　　删除光标所在位置开始向右的n个字符
dw　　　　若光标处在某个词的中间，则从光标所在的位置开始删至词尾(连同词后的若干空格，制表符)
ndw　　　　删除光标所在的单词开始的n个单词(第一个单词从光标所处的字符开始删)
db　　　　光标所在单词的前一个字符至单词的首字符
ndb　　　　删除光标所在的单词前n哥单词
dd　　　　删除光标所在的整行
ndd　　　　删除当前行及其后n-1行
dG　　　　删除当前行到最后一行
d1G　　　　删除当前行到第一行
d$　　　　删除当前字符到行尾
d0　　　　删除前一个字符到行首
d,左箭头　　删除光标处的前一个字符
d,右箭头　　删除光标处的字符
d,上箭头　　删除当前行和上一行
d,下箭头　　删除当前行和下一行
复制和粘贴
yy　　　　当前行复制到缓冲区
nyy　　　　当前开始的n行复制到缓冲区
yG　　　　光标所在行至最后一行复制到缓冲区
y1G　　　　光标所在行至第一行复制到缓冲区
y$　　　　光标所在位置到行尾复制到缓冲区
y0　　　　光标所在位置的前一个字符到行首复制到缓冲区
p　　　　将缓冲区的内容写到光标所在的位置
搜索字符串
/str　　　　往右移动到有str的地方
?str　　　　往左移动到有str的地方
n　　　　向相同的方向移动
N　　　　向相反的方向移动
撤销和重复
U　　　　取消前一次的误操作或不合适的操作对文件造成的影响
.　　　　再执行一次前面刚完成的某个命令
退出Vi
ZZ　　　　存盘退出
ZQ　　　　不保存退出
二、命令行模式下的操作
跳行
:n　　　　跳转到第n行

字符串搜索和替换
:/str/　　　　　　　　　　从当前往右移动到有str的地方
:?str?　　　　　　　　　　从当前往左移动到有str的地方
:/str/w file　　　　　　　　将包含有str的行写到文件file中
:/str1/,/str2/w file　　　　将从str1开始到str2结束的内容写入到file文件中
:s/str1/str2/　　　　　　将找到的第一个str1替换为str2　　
:s/str2/str2/g　　　　　　将当前行找到的所有str1替换为str2
:n1,n2s/str1/str2/g　　　　将从n1行至n2行找到的所有的str1替换为str2
:1,.s/str1/str2/g　　　　　　将从第1行至当前行的所有str1替换为str2
:.,$s/str1/str2/g　　　　　　将从当前行至最后一行的所有str1替换为str2
:1,$s/str1/str2/gc　　　　　将从第1行至最后一行的所有str1替换为str2，并在替换前询问
文本的复制、移动和删除
:n1,n2 co n3　　　　将n1行至n2行复制到n3后面
:n1,n2 m n3　　　　将n1行至n2行移动到n3后面
:d　　　　　　　　　删除当前行
:nd　　　　　　　　 删除第n行
:n1,n2 d　　　　　　删除n1行至n2行
:.,$d　　　　　　　　删除当前行至最后一行
:/str1/,/str2/d　　　删除从str1开始至str2为止的内容
文件相关命令
:w　　　　　　　当前编辑的内容存盘
:w file　　　　　当前编辑的内容写到file中
:n1,n2w file　　从n1行至n2行写到file中
:nw file　　　　　第n行写到文件file中
:1,.w file　　　　从第1行至当前行写到file中
:.,$w file　　　　从当前行至最后一行写到file中
:r file　　　　　　打开另一个文件file
:e file　　　　　　新建file文件　　　　　　　　
:f file 　　　　　　当前文件改名为file
执行Shell命令
:!Cmd　　　　　　　　运行Shell命令Cmd
:n1,n2 w !Cmd　　　将n1行至n2行做为Cmd命令的输入，若不指定行则整个文件做为Cmd的输入
:r !Cmd　　　　　　　将命令运行的结果写入光标所在行的下一行(命令不能是别名)
设置Vi环境
:set autoindent　　　　　　自动缩进
:set noautoindent　　　　　取消自动缩进
:set number　　　　　　　　在编辑文件时显示行号
:set nonumber　　　　　　不显示行号
:set ruler　　　　　　　　　　在屏幕底部显示光标所在的行，列位置
:set noruler　　　　　　　　不显示行，列位置
:set tabstop=value　　　　设置显示制表符的空格字符个数
:set wrapmargin=value　　设置显示器的右页边。当输入进入所设置的页边时，编辑器自动回车换行
:set　　　　　　　　　　　　显示设置的所有选项
:set all　　　　　　　　　　显示所欲可以设置的选项
退出Vi
:q　　　　退出
:qw　　　保存并退出
:q!　　　 不保存退出
